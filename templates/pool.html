{% extends "base.html" %}

{% block title %}{{pool.name}}{% endblock %}

{% block head %}
{{ super() }}
<script type="text/javascript" src="/static/jquery.tablesorter.min.js"></script>
<script type="text/javascript" src="/static/pool.js"></script>
<link type="text/css" rel="stylesheet" href="/static/pool.css" />
{% endblock %}

{% block content %}
<div class="page-header" style="position:relative;">
  <h1 style="text-align:center">{{pool.name}}</h1>
  {% if pool.admin_user.id == user.id %}
  <div>
    <p style="position:absolute; bottom:0; right:0; margin-bottom:19px; margin-right:5px;"><a href="/pools/{{pool.id}}/admin">Admin Dashboard</a></p>
  </div>
  {% endif %}
</div>
<p style="text-align:center;">
  {% if not locked %}
  <a href="/brackets/choose?p={{pool.id}}" class="btn btn-primary btn-large">Enter a Bracket</a>
  {% else %}
  <a href="/pools/{{pool.id}}/master" class="btn btn-primary btn-large">View Master Bracket/Game Analysis</a>
  <a href="/pools/{{pool.id}}/usersimilarity" class="btn btn-info btn-large">See how similar you are to others</a>
  {% endif %}
</p>

<!-- Rules Modal -->
<!-- Button to trigger modal -->
<div class="span2 offset10"><a href="#myModal" role="button" class="btn" data-toggle="modal">Pool Rules</a>
 
<!-- Modal -->
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
    <h3 id="myModalLabel">Rules for {{pool.name}}</h3>
  </div>
  <div class="modal-body">
    <h4>Points per Round</h4>
    <table style="table-layout:fixed; border:solid">
      <thead>
        <tr>
          <th style="text-align:center; width:18%">Round 1</th>
          <th style="text-align:center; width:18%">Round 2</th>
          <th style="text-align:center; width:18%">Sweet Sixteen</th>
          <th style="text-align:center; width:18%">Elite Eight</th>
          <th style="text-align:center; width:18%">Final Four</th>
          <th style="text-align:center; width:18%">Championship</th>
        </tr>
      </thead>
      <tbody><tr>
      {% for p in pool.points %}
        <td style="text-align:center">{{p}}</td>
      {% endfor %}
      </tbody>
    </table>
    <h4>Bonus Option</h4>
    {% if pool.bonus == 'seed' %}
      <strong>Seed</strong>: You get these bonus points for every correct pick. This bonus adds the seed to the points for correct pick.
      <p>For example, in a Round 1 game, you pick the #12 seed to win:
      You would get <strong>{{pool.points[0]}} points </strong> for picking the game correctly, plus <strong>12 bonus points</strong>
    {% elif pool.bonus == 'upset' %}
      <strong>Upset</strong>: You get these bonus points for picking lower seeded teams to win. This bonus is calculated as the difference between the seeds when the lower seed wins.
      <p>For example, in a Round 1 game, you pick the #12 seed to upset the #5:
      You would get {{pool.points[0]}} points for picking the game correctly, plus 7 bonus points (#12 - #5)
    {% else %}
      No Bonus
    {% endif %}
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
  </div>
</div>


</div>
<h2>Standings</h2>
<div class="mod-content" style="font-size:13px;">
  <table id="standings" class="table table-striped table-hover tablesorter">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Bracket Name</th>
        <th>Total Score</th>
        <th>Rd 1</th>
        <th>Rd 2</th>
        <th>SS</th>
        <th>EE</th>
        <th>FF</th>
        <th>Champ</th>
        <th>Prior Rank</th>
        <th>Change in Rank</th>
        <th>Max Score</th>
        <th>Max Score Rank</th>
      </tr>
    </thead>
    <tbody>
      {% for e in entries %}
      <tr class="{{loop.cycle('odd', 'even')}} {% if e.own %}user-entry{% endif %}" {% if locked or e.own %}onclick="document.location.href = '/brackets/{{e.id}}';"{% endif %}}>
        <td>{{e.rank}}</td>
        <td>{{e.name}}</td>
        <td style="text-align:center;">{{'{0:.3g}'.format(e.points.total)}}</td>
        <td style="text-align:center;">{{'{0:.3g}'.format(e.points.round_1)}}</td>
        <td style="text-align:center;">{{'{0:.3g}'.format(e.points.round_2)}}</td>
        <td style="text-align:center;">{{'{0:.3g}'.format(e.points.round_3)}}</td>
        <td style="text-align:center;">{{'{0:.3g}'.format(e.points.round_4)}}</td>
        <td style="text-align:center;">{{'{0:.3g}'.format(e.points.round_5)}}</td>
        <td style="text-align:center;">{{'{0:.3g}'.format(e.points.round_6)}}</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}